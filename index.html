
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Поздравительное видео</title>
    <!-- Tailwind CSS для стилей -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React и ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel для запуска JSX в браузере -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        body {
            margin: 0;
            padding: 0;
            min-height: 100vh;
            background: linear-gradient(to bottom, #7f1d1d, #dc2626, #450a0a);
            background-attachment: fixed;
            overflow-x: hidden;
        }

        /* Контейнер для снега */
        .snow-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .snowflake {
            color: #fff;
            position: absolute;
            top: -20px;
            user-select: none;
            animation-name: fall, shake;
            animation-iteration-count: infinite;
            animation-timing-function: linear, ease-in-out;
            opacity: 0.8;
            filter: drop-shadow(0 0 2px rgba(255,255,255,0.5));
        }

        @keyframes fall {
            0% { top: -20px; }
            100% { top: 100vh; }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            50% { transform: translateX(40px); }
        }

        /* Тонкая белая рамка плеера */
        .player-frame {
            border: 2px solid rgba(255, 255, 255, 0.9);
            border-radius: 24px;
            box-shadow: 0 30px 60px -12px rgba(0, 0, 0, 0.8);
        }

        #root {
            position: relative;
            z-index: 10;
        }
    </style>
<script type="importmap">
{
  "imports": {
    "react/": "https://esm.sh/react@^19.2.3/",
    "react": "https://esm.sh/react@^19.2.3",
    "react-dom/": "https://esm.sh/react-dom@^19.2.3/"
  }
}
</script>
</head>
<body class="font-sans antialiased">
    <div class="snow-container">
        <!-- Снежинки для атмосферы -->
        <div class="snowflake" style="left: 2%; font-size: 1.5em; animation-duration: 8s, 3s; animation-delay: 0s, 0s;">❅</div>
        <div class="snowflake" style="left: 7%; font-size: 1em; animation-duration: 12s, 4s; animation-delay: 1s, 0.5s;">❆</div>
        <div class="snowflake" style="left: 18%; font-size: 1.4em; animation-duration: 11s, 5s; animation-delay: 0.5s, 0.2s;">❅</div>
        <div class="snowflake" style="left: 30%; font-size: 1.3em; animation-duration: 10s, 3s; animation-delay: 1.5s, 0.7s;">✻</div>
        <div class="snowflake" style="left: 42%; font-size: 1.5em; animation-duration: 9s, 5s; animation-delay: 2.5s, 0.5s;">❆</div>
        <div class="snowflake" style="left: 54%; font-size: 1.2em; animation-duration: 14s, 4s; animation-delay: 5s, 1.2s;">❅</div>
        <div class="snowflake" style="left: 66%; font-size: 1em; animation-duration: 12s, 4s; animation-delay: 7s, 1.5s;">✻</div>
        <div class="snowflake" style="left: 80%; font-size: 1.4em; animation-duration: 13s, 4s; animation-delay: 2s, 1s;">❅</div>
        <div class="snowflake" style="left: 92%; font-size: 1.1em; animation-duration: 11s, 3s; animation-delay: 4s, 0s;">❆</div>
        <!-- Дополнительный слой снега -->
        <div class="snowflake" style="left: 15%; font-size: 1em; animation-duration: 15s, 4s; animation-delay: 3s, 1s;">✻</div>
        <div class="snowflake" style="left: 45%; font-size: 1.2em; animation-duration: 12s, 3s; animation-delay: 1s, 0s;">❅</div>
        <div class="snowflake" style="left: 75%; font-size: 1.5em; animation-duration: 14s, 5s; animation-delay: 6s, 2s;">❆</div>
    </div>

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect, useCallback } = React;

        // --- Иконки ---
        const PlayIcon = ({ className = "w-6 h-6" }) => (
            <svg viewBox="0 0 24 24" fill="currentColor" className={className}><path d="M8 5v14l11-7z" /></svg>
        );
        const FullscreenIcon = ({ className = "w-6 h-6" }) => (
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3" />
            </svg>
        );
        const ExitFullscreenIcon = ({ className = "w-6 h-6" }) => (
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M4 14h6m0 0v6m0-6-7 7M20 10h-6m0 0V4m0 6 7-7" />
            </svg>
        );
        const ReplayIcon = ({ className = "w-6 h-6" }) => (
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M1 4v6h6" /><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10" />
            </svg>
        );

        // --- Видеоплеер ---
        const VideoPlayer = ({ src }) => {
            const videoRef = useRef(null);
            const containerRef = useRef(null);
            const controlsTimeoutRef = useRef(null);
            const wakeLockRef = useRef(null);

            const [isPlaying, setIsPlaying] = useState(false);
            const [showControls, setShowControls] = useState(true);
            const [currentTime, setCurrentTime] = useState(0);
            const [duration, setDuration] = useState(0);
            const [isFullscreen, setIsFullscreen] = useState(false);

            const togglePlay = () => {
                if (videoRef.current) {
                    if (isPlaying) videoRef.current.pause();
                    else videoRef.current.play();
                    setIsPlaying(!isPlaying);
                }
            };

            const handleUserInteraction = () => {
                setShowControls(true);
                if (controlsTimeoutRef.current) window.clearTimeout(controlsTimeoutRef.current);
                if (isPlaying) {
                    controlsTimeoutRef.current = window.setTimeout(() => setShowControls(false), 3000);
                }
            };

            const toggleFullscreen = async () => {
                if (!containerRef.current) return;
                try {
                    if (!document.fullscreenElement) {
                        await containerRef.current.requestFullscreen();
                        setIsFullscreen(true);
                    } else {
                        await document.exitFullscreen();
                        setIsFullscreen(false);
                    }
                } catch (err) { console.error(err); }
            };

            const handleSeek = (e) => {
                if (!videoRef.current || !duration) return;
                const rect = e.currentTarget.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const newTime = (x / rect.width) * duration;
                videoRef.current.currentTime = newTime;
                setCurrentTime(newTime);
            };

            useEffect(() => {
                const handleFs = () => setIsFullscreen(!!document.fullscreenElement);
                document.addEventListener('fullscreenchange', handleFs);
                return () => document.removeEventListener('fullscreenchange', handleFs);
            }, []);

            const progressPercentage = duration ? (currentTime / duration) * 100 : 0;

            return (
                <div className="w-full flex flex-col items-center">
                    <div 
                        ref={containerRef}
                        className={`relative w-full bg-black overflow-hidden select-none transition-all duration-500
                            ${isFullscreen ? 'h-screen rounded-none border-none' : 'aspect-video player-frame'}`}
                        onMouseMove={handleUserInteraction}
                        onTouchStart={handleUserInteraction}
                    >
                        <video
                            ref={videoRef}
                            src={src}
                            className="w-full h-full object-contain cursor-pointer"
                            playsInline
                            onClick={togglePlay}
                            onTimeUpdate={() => setCurrentTime(videoRef.current.currentTime)}
                            onLoadedMetadata={() => setDuration(videoRef.current.duration)}
                            onEnded={() => { setIsPlaying(false); setShowControls(true); }}
                        />

                        {!isPlaying && (
                            <div className="absolute inset-0 flex items-center justify-center bg-black/40 backdrop-blur-[1px] pointer-events-none">
                                <button 
                                    onClick={(e) => { e.stopPropagation(); togglePlay(); }}
                                    className="w-24 h-24 md:w-32 md:h-32 bg-red-600 rounded-full flex items-center justify-center text-white 
                                        shadow-[0_15px_35px_rgba(220,38,38,0.4)] hover:scale-105 active:scale-95 transition-transform pointer-events-auto"
                                >
                                    {currentTime >= duration ? <ReplayIcon className="w-12 h-12" /> : <PlayIcon className="w-12 h-12 pl-1" />}
                                </button>
                            </div>
                        )}

                        <div className={`absolute bottom-0 left-0 right-0 px-4 pb-4 md:px-6 md:pb-6 bg-gradient-to-t from-black/80 transition-opacity duration-500 ${showControls || !isPlaying ? 'opacity-100' : 'opacity-0'}`}>
                            <div className="w-full h-1.5 bg-white/20 cursor-pointer relative rounded-full overflow-hidden" onClick={handleSeek}>
                                <div className="h-full bg-gradient-to-r from-red-600 to-red-400 rounded-full" style={{ width: `${progressPercentage}%` }} />
                            </div>
                        </div>
                    </div>

                    {!isFullscreen && (
                        <div className="mt-6 flex justify-center w-full">
                            <button onClick={toggleFullscreen} className="flex items-center gap-2 px-6 py-2 bg-white/10 hover:bg-white/20 backdrop-blur-md rounded-full text-white/90 hover:text-white transition-all text-sm font-bold tracking-wider uppercase">
                                <FullscreenIcon className="w-5 h-5" />
                                <span>На весь экран</span>
                            </button>
                        </div>
                    )}
                </div>
            );
        };

        // --- Главное приложение ---
        const App = () => {
            const videoSource = "https://storage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4";

            return (
                <div className="min-h-screen flex flex-col items-center justify-center px-6 py-10 md:p-12">
                    <header className="w-full max-w-4xl text-center mb-8">
                        <h1 className="text-4xl sm:text-6xl md:text-8xl font-black text-white uppercase tracking-tight mb-4 drop-shadow-2xl italic whitespace-nowrap" style={{ fontFamily: 'Georgia, serif' }}>
                            С праздником!
                        </h1>
                        <div className="inline-block px-4 py-1 bg-white/10 backdrop-blur-sm rounded-full">
                            <p className="text-red-100 text-xs sm:text-sm md:text-xl font-medium">Твое персональное поздравление ✨</p>
                        </div>
                    </header>

                    <main className="w-full max-w-3xl flex-grow flex items-center justify-center">
                        <VideoPlayer src={videoSource} />
                    </main>

                    <footer className="w-full mt-10 text-center">
                        <p className="text-white/40 text-[11px] font-bold tracking-[0.5em] uppercase">2025 • Сделано с любовью</p>
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
